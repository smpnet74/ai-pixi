# ============================================================================
# AI Development Environment - Comprehensive Pixi Configuration
# ============================================================================
# This pixi.toml provides parity with the ai-menu project installation capabilities.
# Run "pixi install" to install all core dependencies and CLI tools.
# For npm/uv/curl-based AI tools, use the tasks in the [tasks] section.
# Author: Scott Peterson <sm_peterson@yahoo.com>
# ============================================================================

[workspace]
name = "ai-pixi"
version = "0.1.0"
description = "Comprehensive AI development environment with all tools from ai-menu"
authors = ["Scott Peterson <sm_peterson@yahoo.com>"]
channels = ["conda-forge"]
platforms = ["linux-64", "linux-aarch64"]

# ============================================================================
# CORE DEPENDENCIES (Always Required)
# ============================================================================
[dependencies]
# Core runtime environments
nodejs = "24.*"
python = "3.12.*"
uv = ">=0.9.28,<0.10"

# CLI utility tools (managed by pixi/conda-forge; available on PATH via shell hook)
ripgrep = "*"
jq = "*"
go-yq = "*"
bat = "*"
fd-find = "*"
eza = "*"
gh = "*"
kubernetes-helm = "*"
lazygit = "*"
pandoc = "*"
typst = "*"

# WeasyPrint C dependencies (required by md2pdf within the pixi Python env)
pycairo = "*"
gdk-pixbuf = "*"
pango = "*"
fontconfig = "*"


# ============================================================================
# PIXI TASKS - Installation and Management Commands
# ============================================================================
[tasks]

# --- Help Command ---
help = { cmd = "bash .pixi-scripts/help.sh" }
setup-shell-hook = { cmd = "bash .pixi-scripts/ensure-shell-hook.sh", description = "Add pixi shell-hook to ~/.bashrc and ~/.zshrc for permanent PATH setup" }

# --- NPM-based AI CLI Tools ---
install-amp       = { cmd = "npm install -g @sourcegraph/amp@latest && echo 'amp installed'", description = "Install Amp by Sourcegraph" }
install-auggie    = { cmd = "npm install -g @augmentcode/auggie && echo 'auggie installed'", description = "Install Auggie by Augment Code" }
install-codex     = { cmd = "npm install -g @openai/codex && echo 'codex installed'", description = "Install Codex by OpenAI" }
install-forgecode  = { cmd = "npm install -g forgecode@latest && echo 'forgecode installed'", description = "Install Forgecode" }
install-gemini    = { cmd = "npm install -g @google/gemini-cli && echo 'gemini installed'", description = "Install Gemini CLI by Google" }
install-grok      = { cmd = "npm install -g @vibe-kit/grok-cli && echo 'grok installed'", description = "Install Grok CLI" }
install-opencode  = { cmd = "npm install -g opencode-ai && echo 'opencode installed'", description = "Install OpenCode CLI" }
install-qodo      = { cmd = "npm install -g @qodo/command && echo 'qodo installed'", description = "Install Qodo CLI" }
install-qoder     = { cmd = "npm install -g @qoder-ai/qodercli && echo 'qoder installed'", description = "Install Qoder by Qwen" }
install-pi        = { cmd = "npm install -g @mariozechner/pi-coding-agent && echo 'pi installed'", description = "Install Pi Coding Agent by Mario Zechner" }

# Batch install all npm-based tools
install-all-npm = { cmd = "npm install -g @sourcegraph/amp@latest @augmentcode/auggie @openai/codex forgecode@latest @google/gemini-cli @vibe-kit/grok-cli opencode-ai @qodo/command @qoder-ai/qodercli @mariozechner/pi-coding-agent && echo 'All npm tools installed'", description = "Install all npm-based AI CLI tools" }

# --- Python/uv-based AI CLI Tools ---
install-kimi      = { cmd = "uv tool install --python 3.13 kimi-cli && echo 'kimi installed'", description = "Install Kimi by MoonshotAI" }
install-openhands = { cmd = "uv tool install openhands && echo 'openhands installed'", description = "Install OpenHands" }
install-modal     = { cmd = "uv pip install modal && echo 'modal installed'", description = "Install Modal serverless platform CLI" }

# Batch install all uv-based tools
install-all-uv = { cmd = "uv tool install --python 3.13 kimi-cli && uv tool install openhands && uv pip install modal && echo 'All uv tools installed'", description = "Install all Python/uv-based AI CLI tools" }

# --- Custom Installer AI CLI Tools (require curl/bash) ---
install-droid = { cmd = "curl -fsSL https://app.factory.ai/cli | sh", description = "Install Droid by Factory AI" }
install-goose = { cmd = "curl -fsSL https://github.com/block/goose/releases/download/stable/download_cli.sh | CONFIGURE=false bash", description = "Install Goose by Block" }
install-kiro = { cmd = "curl -fsSL https://cli.kiro.dev/install | bash", description = "Install Kiro CLI by AWS" }
install-plandex = { cmd = "curl -sL https://plandex.ai/install.sh | bash", description = "Install Plandex" }

# Batch install all custom installer tools
install-all-custom = { cmd = "curl -fsSL https://app.factory.ai/cli | sh && curl -fsSL https://github.com/block/goose/releases/download/stable/download_cli.sh | CONFIGURE=false bash && curl -fsSL https://cli.kiro.dev/install | bash && curl -sL https://plandex.ai/install.sh | bash", description = "Install all custom installer AI CLI tools" }

# --- CLI Enhancers ---
install-claude-flow = { cmd = "npm install -g claude-flow@alpha && echo 'claude-flow installed'", description = "Install Claude Flow by ruvnet" }

# --- Orchestrators ---
install-openclaw = { cmd = "npm install -g openclaw@latest && echo 'openclaw installed'", description = "Install OpenClaw orchestrator" }

# --- AI Agent Utilities ---
install-mcporter = { cmd = "npm install -g mcporter && echo 'mcporter installed'", description = "Install MCPorter - MCP TypeScript runtime and CLI toolkit" }

# --- Required by OpenClaw ---
install-homebrew = { cmd = "bash .pixi-scripts/install-homebrew.sh", description = "Install Homebrew package manager (required by OpenClaw)" }

install-spec-kit = { cmd = "uv tool install --from git+https://github.com/github/spec-kit.git specify-cli && echo 'spec-kit installed'", description = "Install Spec Kit by GitHub" }

# --- Install Everything ---
install-all = { cmd = """
echo 'üì¶ Installing all npm-based tools...' && \
MANIFEST=$(cd $(dirname ${BASH_SOURCE[0]:-$0}) 2>/dev/null && pwd || pwd)/pixi.toml && \
pixi run --manifest-path $MANIFEST install-all-npm && \
echo '' && echo 'üêç Installing all uv-based tools...' && \
pixi run --manifest-path $MANIFEST install-all-uv && \
echo '' && echo 'üîß Installing custom installer tools...' && \
pixi run --manifest-path $MANIFEST install-all-custom && \
echo '' && echo '‚ú® Installing CLI enhancers...' && \
pixi run --manifest-path $MANIFEST install-claude-flow && \
pixi run --manifest-path $MANIFEST install-spec-kit && \
echo '' && echo '‚úì All tools installed! Run: pixi run setup-shell-hook then source ~/.zshrc'
""", description = "Install ALL AI CLI tools" }

# --- VS Code Extensions ---
install-vscode-augment = { cmd = "code --install-extension augment.vscode-augment", description = "Install Augment Code extension" }
install-vscode-kilo = { cmd = "code --install-extension kilocode.kilo-code", description = "Install Kilo Code extension" }
install-vscode-roo = { cmd = "code --install-extension rooveterinaryinc.roo-cline", description = "Install Roo Code extension" }
install-vscode-cline = { cmd = "code --install-extension saoudrizwan.claude-dev", description = "Install Cline (Claude Dev) extension" }
install-vscode-zencoder = { cmd = "code --install-extension zencoderai.zencoder", description = "Install Zencoder extension" }

# Batch install all VS Code extensions
install-all-vscode = { depends-on = ["install-vscode-augment", "install-vscode-kilo", "install-vscode-roo", "install-vscode-cline", "install-vscode-zencoder"], description = "Install all VS Code extensions" }

# --- Special System Tools (managed by conda-forge via pixi install) ---
install-ripgrep  = { cmd = "rg --version && echo 'ripgrep managed by pixi (conda-forge)'", description = "Verify ripgrep - installed via conda-forge" }
install-jq       = { cmd = "jq --version && echo 'jq managed by pixi (conda-forge)'", description = "Verify jq - installed via conda-forge" }
install-yq       = { cmd = "yq --version && echo 'yq managed by pixi (conda-forge)'", description = "Verify yq - installed via conda-forge" }
install-bat      = { cmd = "bat --version && echo 'bat managed by pixi (conda-forge)'", description = "Verify bat - installed via conda-forge" }
install-fd       = { cmd = "fd --version && echo 'fd managed by pixi (conda-forge)'", description = "Verify fd - installed via conda-forge" }
install-eza      = { cmd = "eza --version && echo 'eza managed by pixi (conda-forge)'", description = "Verify eza - installed via conda-forge" }
install-gh       = { cmd = "gh --version && echo 'gh managed by pixi (conda-forge)'", description = "Verify GitHub CLI - installed via conda-forge" }
install-helm     = { cmd = "helm version --short && echo 'helm managed by pixi (conda-forge)'", description = "Verify helm - installed via conda-forge" }
install-lazygit  = { cmd = "lazygit --version && echo 'lazygit managed by pixi (conda-forge)'", description = "Verify lazygit - installed via conda-forge" }

# Batch verify all special tools
install-all-special = { cmd = """
echo 'üîß Verifying special system tools (managed by conda-forge)...' && \
rg --version && jq --version && yq --version && bat --version && \
fd --version && eza --version && gh --version && helm version --short && \
lazygit --version && pandoc --version | head -n1 && typst --version && \
echo '‚úì All special tools available via pixi!'
""", description = "Verify all special system tools (installed via pixi/conda-forge)" }

# --- PDF Generation Tools ---
install-pandoc = { cmd = "pandoc --version | head -n1 && typst --version && echo 'pandoc and typst managed by pixi (conda-forge)'", description = "Verify Pandoc and Typst - installed via conda-forge" }

install-md2pdf = { cmd = "uv pip install 'md2pdf[cli]' && echo 'md2pdf installed into pixi Python env'", description = "Install md2pdf (WeasyPrint C deps via conda-forge)" }

# --- Management Commands ---
list-installed = { cmd = "npm list -g --depth=0", description = "List all globally installed npm packages" }
list-uv-tools = { cmd = "uv tool list", description = "List all installed uv tools" }

# --- Shell Setup (alias management replaced by shell hook) ---
setup-aliases-npm = { cmd = "echo 'Aliases replaced by shell hook. Run: pixi run setup-shell-hook'", description = "(deprecated) Use setup-shell-hook" }
setup-aliases-uv  = { cmd = "echo 'Aliases replaced by shell hook. Run: pixi run setup-shell-hook'", description = "(deprecated) Use setup-shell-hook" }


# For available commands:  pixi run help
# For full documentation:  see README.md
